\documentclass[a4paper,12pt]{article}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
\usepackage{amsmath}
\usepackage{polski}
\usepackage{float}

\title{Raport podsumowujący}
\date{Data wygenerowania raportu: \today}

\begin{document}

\maketitle
\section*{Liczba przeanalizowanych raportów}
W niniejszym podsumowaniu przeanalizowano \textbf{<<total_reports>>} raportów resuscytacyjnych.

\section{Mechanizmy nagłego zatrzymania krążenia (NZK)}
\begin{table}[H]
\centering
\begin{tabular}{@{}lcc@{}}
\toprule
Mechanizm & Liczba wystąpień & Proporcja [\%] \\ \midrule
<<mechanisms_data>> \bottomrule
\end{tabular}
\caption{Liczba wystąpień poszczególnych mechanizmów i ich proporcje.}
\end{table}

% Wykres mechanizmów
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{mechanisms_chart.png}
    \caption{Proporcja mechanizmów NZK względem całości raportów.}
\end{figure}

\section{Czas trwania resuscytacji}
\begin{table}[H]
\centering
\begin{tabular}{@{}lc@{}}
\toprule
Metryka & Wartość \\ \midrule
Najkrótszy czas & <<min_time>> min \\
Najdłuższy czas & <<max_time>> min \\
Średni czas & <<mean_time>> min \\
Mediana czasu & <<median_time>> min \\
Odchylenie standardowe & <<std_time>> min \\
Procent raportów bez podanego czasu & <<missing_time_percentage>> \% \\ \bottomrule
\end{tabular}
\caption{Statystyki czasu trwania resuscytacji.}
\end{table}

\section{Procedury}
\begin{table}[H]
\centering
\begin{tabular}{@{}lccccc@{}}
\toprule
Kategoria & Procedura & Wystąpienia & Proporcja [\%] & ROSC [\%] & Zgony [\%] \\ \midrule
<<procedures_data>> \bottomrule
\end{tabular}
\caption{Liczba wystąpień procedur z podziałem na kategorie i ich proporcje.}
\end{table}

% Wykres procedur
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{procedures_chart.png}
    \caption{Wystąpienia poszczególnych procedur.}
\end{figure}

% Trzy najczęstsze współwystępowania
\begin{table}[H]
\centering
\begin{tabular}{@{}lccccc@{}}
\toprule
Metody & Wystąpienia & Proporcja [\%] & ROSC [\%] & Zgony [\%] \\ \midrule
<<cooccurrences_data>> \bottomrule
\end{tabular}
\caption{Trzy najczęstsze współwystępowania metod RKO.}
\end{table}

\section{Wyniki resuscytacji}
\begin{table}[H]
\centering
\begin{tabular}{@{}lcc@{}}
\toprule
Wynik & Liczba raportów & Proporcja [\%] \\ \midrule
<<results_summary>> \bottomrule
\end{tabular}
\caption{Liczba raportów z wynikami.}
\end{table}

\begin{table}[H]
\centering
\begin{tabular}{@{}lccc@{}}
\toprule
Mechanizm & Procent ROSC (\%) & Procent zgonów (\%) & Średni czas [min] \\ \midrule
<<mechanism_dependency>> \bottomrule
\end{tabular}
\caption{Zależności wyników RKO od mechanizmów NZK i średni czas.}
\end{table}

\end{document}